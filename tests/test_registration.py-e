from selenium import webdriver  # Добавляем этот импорт
from selenium.webdriver.chrome.service import Service as ChromeService
from webdriver_manager.chrome import ChromeDriverManager
import time

def test_debug():
    try:
        # Автоматически скачиваем и устанавливаем chromedriver
        print("Устанавливаю ChromeDriver...")
        service = ChromeService(ChromeDriverManager().install())

        # Создаем драйвер
        print("Запускаю браузер...")
        driver = webdriver.Chrome(service=service)

        try:
            # Открываем страницу регистрации
            print("Открываю страницу регистрации...")
            driver.get("https://stellarburgers.nomoreparties.site/register")
            time.sleep(3)  # Даем странице время загрузиться

            # Печатаем заголовок страницы
            print("Заголовок страницы:", driver.title)

            # Пробуем найти поле email
            print("Пробую найти поле email...")
            email_field = None

            # Вариант 1: По XPATH
            try:
                email_field = driver.find_element("xpath", "//input[@type='email']")
                print("Успех! Нашел поле по XPATH: //input[@type='email']")
            except Exception as e:
                print(f"Не удалось найти по XPATH: {str(e)}")

            # Вариант 2: По CSS селектору
            if email_field is None:
                try:
                    email_field = driver.find_element("css selector", "input[type=email]")
                    print("Успех! Нашел поле по CSS: input[type=email]")
                except Exception as e:
                    print(f"Не удалось найти по CSS: {str(e)}")

            # Вариант 3: По имени
            if email_field is None:
                try:
                    email_field = driver.find_element("name", "email")
                    print("Успех! Нашел поле по имени: email")
                except Exception as e:
                    print(f"Не удалось найти по имени: {str(e)}")

            # Если поле найдено, заполняем его
            if email_field is not None:
                email_field.send_keys("test@example.com")
                print("Поле email заполнено успешно!")
            else:
                print("\nНе удалось найти поле email. Вывожу фрагмент HTML-кода:")
                print(driver.page_source[:2000])  # Первые 2000 символов кода
                print("\nСкриншот страницы сохранен как debug_screenshot.png")
                driver.save_screenshot("debug_screenshot.png")

        finally:
            # Закрываем браузер в любом случае
            print("Закрываю браузер...")
            driver.quit()

    except Exception as e:
        print(f"\nПроизошла ошибка при инициализации: {str(e)}")

    print("Тест завершен!")

if __name__ == "__main__":
    test_debug()